<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" integrity="sha384-Zug+QiDoJOrZ5t4lssLdxGhVrurbmBWopoEl+M6BdEfwnCJZtKxi1KgxUyJq13dy" crossorigin="anonymous">
  <link rel="stylesheet" href="css/master.css">
  <title>Rock Paper Scissors</title>
</head>
<body>

  <main class="container">


    <div class="card text-center">
      <div class="card-header">

        <h1 id="round">Make your play!</h1>
        <h4 id="result"></h4>
      </div>
      <div class="card-body">

        <div class="btn-group" role="group" aria-label="Basic example">
          <button id="rock" type="button" class="btn btn-lg btn-dark">Rock</button>
          <button id="paper" type="button" class="btn btn-lg btn-ligth">Paper</button>
          <button id="scissors" type="button" class="btn btn-lg btn-warning">Scissors</button>
        </div>
      </div>
      <div class="card-footer text-muted">

        <button type="button" class="btn btn-success btn-lg" disabled>
          Won <span id="win" class="badge badge-light">0</span>
        </button>
        <button type="button" class="btn btn-danger btn-lg" disabled>
          Lost <span id="loss" class="badge badge-light">0</span>
        </button>
        </div>
    </div>


  </main>


  <script type="text/javascript">
  const body = document.querySelector('body');
  const card = document.querySelector('.card');
  const cardBody = document.querySelector('.card-body');
  const btnGroup = document.querySelector('.btn-group');

  function computerPlay() {
    var play = ['Rock','Paper','Scissor'];
    function getRandomInt(max) {
      return Math.floor(Math.random() * Math.floor(max));
    }
    var play = ['Rock','Paper','Scissor'];
    return play[getRandomInt(3)];
  }
  function playRound(player1,player2) {
    player1 = player1.toLowerCase();
    player2 = player2.toLowerCase();
    if (player1 == player2) {
      return "It's a draw.";
    } else if (player1.startsWith("r") === true) {
      if (player2.startsWith("s") === true) {
        return "Rock beats Scissors.";
      } else {
        return "Paper beats Rock.";
      }
    } else if (player1.startsWith("p") === true) {
      if (player2.startsWith("r") === true) {
        return "Paper beats Rock.";
      } else {
        return "Scissors beat Paper.";
      }
    } else {
      if (player2.startsWith("p") === true) {
        return "Scissors beats Paper.";
      } else {
        return "Rock beats Scissors.";
      }
    }
  }

  // we use the .forEach method to iterate through each button
  const buttons = document.querySelectorAll('button');
  var win = 0
  var loss = 0
  var color = ""
  var result = ""



  buttons.forEach((button) => {
    // and for each one we add a 'click' listener
    button.addEventListener('click', (e) => {

      function game() {
        const playerSelection = button.id;
        const computerSelection = computerPlay();
        const round = playRound(playerSelection,computerSelection)
        document.getElementById("round").innerHTML = round;
        if (!round.toLowerCase().startsWith("i")) {
          if (round.toLowerCase().startsWith(playerSelection.charAt(0)) === true) {
            win += 1
            document.getElementById("win").innerHTML = win;
            color = "#4ea76a"
            result = "Point goes to you!"
          } else {
            loss += 1
            document.getElementById("loss").innerHTML = loss;
            color = "#ce636f"
            result = "Point goes to the computer."
          }
        } else {
          color = "slategray"
          result = ""
        }
        if (win == 5) {
          result = "You Won!"
        } else {
          result = "You Lost!"
        }
        body.setAttribute('style', `background: ${color}`);
        document.getElementById("result").innerHTML = result;
        if (win == 5 || loss == 5) {
          cardBody.removeChild(btnGroup);
          const newGameButton = document.createElement('button');
          newGameButton.classList.add('btn','btn-secondary');
          newGameButton.textContent = "New Game"
          cardBody.appendChild(newGameButton);
          newGameButton.onclick = () => location.reload();
        }
      }

      while (win < 5 && loss < 5) {
        return game();
      }

    });
  });
  </script>
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/js/bootstrap.min.js" integrity="sha384-a5N7Y/aK3qNeh15eJKGWxsqtnX/wWdSZSKp+81YjTmS15nvnvxKHuzaWwXHDli+4" crossorigin="anonymous"></script>

</body>
</html>
